import { View } from '@nativescript/core';
const getClassName = (instance) => instance.constructor.name;
export class InvisibleNode extends View {
    constructor(name = '') {
        super();
        this.name = name;
        this.nodeType = 1;
        this.nodeName = getClassName(this);
    }
    toString() {
        return `${this.nodeName}(${this.id})-${this.name}`;
    }
}
export class CommentNode extends InvisibleNode {
    constructor(value) {
        super(value);
        this.meta = {
            skipAddToDom: true,
        };
        this.id = CommentNode.id.toString();
        CommentNode.id += 1;
    }
}
CommentNode.id = 0;
export class TextNode extends InvisibleNode {
    get text() {
        return this._text;
    }
    set text(t) {
        this._text = t;
        this.notify({ eventName: TextNode.textChangeEvent, object: this, value: t });
    }
    constructor(value) {
        super(value);
        this._text = '';
        this.callbackMap = new Map();
        this._text = value;
        this.meta = {
            skipAddToDom: true,
        };
        this.id = TextNode.id.toString();
        TextNode.id += 1;
    }
    registerTextChange(callback, id) {
        const cb = (evt) => callback(evt.value);
        const cbArr = this.callbackMap.get(id) || [];
        cbArr.push(cb);
        this.callbackMap.set(id, cbArr);
        this.on('textChange', cb);
    }
    unregisterTextChange(id) {
        const cbArr = this.callbackMap.get(id) || [];
        cbArr.forEach((cb) => this.off('textChange', cb));
        this.callbackMap.delete(id);
    }
}
TextNode.textChangeEvent = 'textChange';
TextNode.id = 0;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW52aXNpYmxlLW5vZGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvYW5ndWxhci9zcmMvbGliL3ZpZXdzL2ludmlzaWJsZS1ub2Rlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFHMUMsTUFBTSxZQUFZLEdBQUcsQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDO0FBRTdELE1BQU0sT0FBZ0IsYUFBYyxTQUFRLElBQUk7SUFXOUMsWUFBc0IsT0FBZSxFQUFFO1FBQ3JDLEtBQUssRUFBRSxDQUFDO1FBRFksU0FBSSxHQUFKLElBQUksQ0FBYTtRQUdyQyxJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQztRQUNsQixJQUFJLENBQUMsUUFBUSxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNyQyxDQUFDO0lBRUQsUUFBUTtRQUNOLE9BQU8sR0FBRyxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ3JELENBQUM7Q0FDRjtBQUVELE1BQU0sT0FBTyxXQUFZLFNBQVEsYUFBYTtJQUc1QyxZQUFZLEtBQWM7UUFDeEIsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRWIsSUFBSSxDQUFDLElBQUksR0FBRztZQUNWLFlBQVksRUFBRSxJQUFJO1NBQ25CLENBQUM7UUFDRixJQUFJLENBQUMsRUFBRSxHQUFHLFdBQVcsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDcEMsV0FBVyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDdEIsQ0FBQzs7QUFWZ0IsY0FBRSxHQUFHLENBQUMsQ0FBQztBQWExQixNQUFNLE9BQU8sUUFBUyxTQUFRLGFBQWE7SUFJekMsSUFBSSxJQUFJO1FBQ04sT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQ3BCLENBQUM7SUFDRCxJQUFJLElBQUksQ0FBQyxDQUFTO1FBQ2hCLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDO1FBQ2YsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLFNBQVMsRUFBRSxRQUFRLENBQUMsZUFBZSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDL0UsQ0FBQztJQUdELFlBQVksS0FBYztRQUN4QixLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFYTCxVQUFLLEdBQUcsRUFBRSxDQUFDO1FBUXJCLGdCQUFXLEdBQUcsSUFBSSxHQUFHLEVBQXNDLENBQUM7UUFJMUQsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFFbkIsSUFBSSxDQUFDLElBQUksR0FBRztZQUNWLFlBQVksRUFBRSxJQUFJO1NBQ25CLENBQUM7UUFDRixJQUFJLENBQUMsRUFBRSxHQUFHLFFBQVEsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDakMsUUFBUSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDbkIsQ0FBQztJQUVELGtCQUFrQixDQUFDLFFBQWdDLEVBQUUsRUFBVztRQUM5RCxNQUFNLEVBQUUsR0FBRyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN4QyxNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDN0MsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNmLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNoQyxJQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxFQUFFLENBQUMsQ0FBQztJQUM1QixDQUFDO0lBRUQsb0JBQW9CLENBQUMsRUFBVztRQUM5QixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDN0MsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNsRCxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUM5QixDQUFDOztBQW5DYSx3QkFBZSxHQUFHLFlBQVksQ0FBQztBQUM1QixXQUFFLEdBQUcsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVmlldyB9IGZyb20gJ0BuYXRpdmVzY3JpcHQvY29yZSc7XG5pbXBvcnQgeyBOZ1ZpZXcgfSBmcm9tICcuL3ZpZXctdHlwZXMnO1xuXG5jb25zdCBnZXRDbGFzc05hbWUgPSAoaW5zdGFuY2UpID0+IGluc3RhbmNlLmNvbnN0cnVjdG9yLm5hbWU7XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBJbnZpc2libGVOb2RlIGV4dGVuZHMgVmlldyBpbXBsZW1lbnRzIE5nVmlldyB7XG4gIG1ldGE6IHsgc2tpcEFkZFRvRG9tOiBib29sZWFuIH07XG4gIG5vZGVUeXBlOiBudW1iZXI7XG4gIG5vZGVOYW1lOiBzdHJpbmc7XG4gIHBhcmVudE5vZGU6IE5nVmlldztcbiAgbmV4dFNpYmxpbmc6IE5nVmlldztcbiAgcHJldmlvdXNTaWJsaW5nOiBOZ1ZpZXc7XG4gIGZpcnN0Q2hpbGQ6IE5nVmlldztcbiAgbGFzdENoaWxkOiBOZ1ZpZXc7XG4gIG5nQ3NzQ2xhc3NlczogTWFwPHN0cmluZywgYm9vbGVhbj47XG5cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIG5hbWU6IHN0cmluZyA9ICcnKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMubm9kZVR5cGUgPSAxO1xuICAgIHRoaXMubm9kZU5hbWUgPSBnZXRDbGFzc05hbWUodGhpcyk7XG4gIH1cblxuICB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gYCR7dGhpcy5ub2RlTmFtZX0oJHt0aGlzLmlkfSktJHt0aGlzLm5hbWV9YDtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQ29tbWVudE5vZGUgZXh0ZW5kcyBJbnZpc2libGVOb2RlIHtcbiAgcHJvdGVjdGVkIHN0YXRpYyBpZCA9IDA7XG5cbiAgY29uc3RydWN0b3IodmFsdWU/OiBzdHJpbmcpIHtcbiAgICBzdXBlcih2YWx1ZSk7XG5cbiAgICB0aGlzLm1ldGEgPSB7XG4gICAgICBza2lwQWRkVG9Eb206IHRydWUsXG4gICAgfTtcbiAgICB0aGlzLmlkID0gQ29tbWVudE5vZGUuaWQudG9TdHJpbmcoKTtcbiAgICBDb21tZW50Tm9kZS5pZCArPSAxO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBUZXh0Tm9kZSBleHRlbmRzIEludmlzaWJsZU5vZGUge1xuICBwdWJsaWMgc3RhdGljIHRleHRDaGFuZ2VFdmVudCA9ICd0ZXh0Q2hhbmdlJztcbiAgcHJvdGVjdGVkIHN0YXRpYyBpZCA9IDA7XG4gIHByb3RlY3RlZCBfdGV4dCA9ICcnO1xuICBnZXQgdGV4dCgpIHtcbiAgICByZXR1cm4gdGhpcy5fdGV4dDtcbiAgfVxuICBzZXQgdGV4dCh0OiBzdHJpbmcpIHtcbiAgICB0aGlzLl90ZXh0ID0gdDtcbiAgICB0aGlzLm5vdGlmeSh7IGV2ZW50TmFtZTogVGV4dE5vZGUudGV4dENoYW5nZUV2ZW50LCBvYmplY3Q6IHRoaXMsIHZhbHVlOiB0IH0pO1xuICB9XG4gIGNhbGxiYWNrTWFwID0gbmV3IE1hcDx1bmtub3duLCBBcnJheTwoZXZ0OiBhbnkpID0+IHZvaWQ+PigpO1xuXG4gIGNvbnN0cnVjdG9yKHZhbHVlPzogc3RyaW5nKSB7XG4gICAgc3VwZXIodmFsdWUpO1xuICAgIHRoaXMuX3RleHQgPSB2YWx1ZTtcblxuICAgIHRoaXMubWV0YSA9IHtcbiAgICAgIHNraXBBZGRUb0RvbTogdHJ1ZSxcbiAgICB9O1xuICAgIHRoaXMuaWQgPSBUZXh0Tm9kZS5pZC50b1N0cmluZygpO1xuICAgIFRleHROb2RlLmlkICs9IDE7XG4gIH1cblxuICByZWdpc3RlclRleHRDaGFuZ2UoY2FsbGJhY2s6ICh0ZXh0OiBzdHJpbmcpID0+IHZvaWQsIGlkOiB1bmtub3duKSB7XG4gICAgY29uc3QgY2IgPSAoZXZ0KSA9PiBjYWxsYmFjayhldnQudmFsdWUpO1xuICAgIGNvbnN0IGNiQXJyID0gdGhpcy5jYWxsYmFja01hcC5nZXQoaWQpIHx8IFtdO1xuICAgIGNiQXJyLnB1c2goY2IpO1xuICAgIHRoaXMuY2FsbGJhY2tNYXAuc2V0KGlkLCBjYkFycik7XG4gICAgdGhpcy5vbigndGV4dENoYW5nZScsIGNiKTtcbiAgfVxuXG4gIHVucmVnaXN0ZXJUZXh0Q2hhbmdlKGlkOiB1bmtub3duKSB7XG4gICAgY29uc3QgY2JBcnIgPSB0aGlzLmNhbGxiYWNrTWFwLmdldChpZCkgfHwgW107XG4gICAgY2JBcnIuZm9yRWFjaCgoY2IpID0+IHRoaXMub2ZmKCd0ZXh0Q2hhbmdlJywgY2IpKTtcbiAgICB0aGlzLmNhbGxiYWNrTWFwLmRlbGV0ZShpZCk7XG4gIH1cbn1cbiJdfQ==